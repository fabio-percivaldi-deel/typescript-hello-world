# Introduction

This repository serve the purpose of having a common, shared and versioned location for swagger files.
Using an OpenAPI specification can highly increase the coordination between API producer and consumer (ex: Frontend team and Backend Team, or be-be).
This project expose a basic webpage that implements the SwaggerUiBundle to display the uploaded swaggers.

# Setup

First of all run `npm install`; we are using a pre-commit hook to prevent you committing broken swagger, the install will setup as your default hook folder `.githooks`, that contains the pre commit hook we want to use.
Before committing automatically the script will check that changed `.json` files are valid OpenAPI specification and if not reject your commit.
To bypass this check you can commit using the `-n` param, this may be helpful in case of error that are not really blockers but that are still detected by the tool.
You can run the validation against one specific file running the command `npm run validate:swagger <path-to-file>` or just use the original CLI command

```
npm run validate:swagger ./swaggers/equities/equities.json
```

# Add a new swagger

## Add the file

In order to add a new swagger locate the folder dedicated to your team, if none exists create a new one, choose the correct module or create a new one and finally put the swagger file inside it.
The file has to be manually generated by the developer at the moment.

```
pattern: /swagger/<team>/<module>/<file>

result: /swaggers/extra/equities/equities.json
```

## Update the CODEOWNERS

In case a new team folder was added in the first step also remember to update the CODEOWNER file accordingly

```
# <team name>
/<folder>                      <github-team-group>

ex:
# Contract Extra
/extra                      @letsdeel/contracts-extra-be

```

this way everything inside the extra folder will be owned by contracts-extra-be team

# Versioning and branching

In order to follow the development cycle we have for backend (and usually other services) it's possible to create feature branches for swagger service too, let's follow the Jira Ticket semantic approach:

`XTR-1234-best-feature-ever`

once the branch is created the pipeline will push swaggers to a specific folder of the bucket with the same name of the branch, this way it will be possible to visualize the correct swaggers on the website.

Remember to clean up your branches when are not needed anymore, this way it will be possible to delete unused files from S3.
